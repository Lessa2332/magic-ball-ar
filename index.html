<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú–∞–≥—ñ—á–Ω–∞ –∫—É–ª—è AR</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mindar@0.5.3/dist/mindar-image-aframe.prod.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: 'Poppins', 'Segoe UI', sans-serif;
      height: 100%;
      width: 100%;
    }
    a-scene {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 1;
    }
    #uiContainer {
      position: fixed;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      text-align: center;
      background: rgba(255,255,255,0.3);
      padding: 10px 15px;
      border-radius: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    #nameInput, #predictButton, #muteButton, #langSelect {
      padding: 8px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid #FFD700;
      margin: 5px;
    }
    #predictButton, #muteButton {
      background: #0A1F44;
      color: #FFD700;
      border: none;
      cursor: pointer;
    }
    #predictButton:hover, #muteButton:hover, #langSelect:hover {
      background: #FFD700;
      color: #0A1F44;
    }
    #nameInput:focus-visible, #predictButton:focus-visible, #muteButton:focus-visible, #langSelect:focus-visible {
      outline: 3px solid #FFD700;
      outline-offset: 2px;
    }
    #signature {
      font-size: 12px;
      color: #0A1F44;
      margin-top: 5px;
    }
    #instructions {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      color: #FFD700;
      font-size: 14px;
      background: rgba(0,0,0,0.5);
      padding: 5px 10px;
      border-radius: 8px;
    }
    @media (max-width: 480px) {
      #uiContainer {
        padding: 8px 10px;
        bottom: 10px;
      }
      #nameInput, #predictButton, #muteButton, #langSelect {
        font-size: 14px;
        padding: 6px;
      }
    }
  </style>
</head>
<body>
  <div id="instructions" role="alert">–í—ñ–¥—Å–∫–∞–Ω—É–π—Ç–µ –º–∞—Ä–∫–µ—Ä –∫–∞–º–µ—Ä–æ—é –¥–ª—è AR</div>
  <main id="uiContainer" role="region" aria-label="–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–∞–≥—ñ—á–Ω–æ—ó –∫—É–ª—ñ">
    <select id="langSelect" aria-label="–û–±—Ä–∞—Ç–∏ –º–æ–≤—É">
      <option value="uk" selected>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
      <option value="en">English</option>
    </select>
    <input id="nameInput" aria-label="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ —ñ–º'—è" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º'—è">
    <button id="predictButton" aria-label="–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è">–ú–∞–≥—ñ—è ‚ú®</button>
    <button id="muteButton" aria-label="–í–∏–º–∫–Ω—É—Ç–∏ –∑–≤—É–∫">üîá</button>
    <div id="signature">@SmartLessa - 2025</div>
  </main>
  <audio id="magicSound" src="assets/magic.mp3"></audio>
  <a-scene mindar-image="imageTargetSrc: assets/targets.mind; showStats: false; maxTrack: 1; filterMinCF: 0.001; filterBeta: 0.01; warmupTolerance: 5;" embedded color-space="sRGB" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: true" aria-label="AR-—Å—Ü–µ–Ω–∞ –∑ –º–∞–≥—ñ—á–Ω–æ—é –∫—É–ª–µ—é">
    <a-camera position="0 0 0" look-controls="enabled: false" webcam="resolution: 1280 720;"></a-camera>
    <a-entity mindar-image-target="targetIndex: 0">
      <a-sphere id="magicSphere" position="0 0.5 0" radius="0.3" color="#0A1F44" opacity="0" segments-width="16" segments-height="16" metalness="0.2" roughness="0.3">
        <a-animation attribute="opacity" from="0" to="0.5" dur="500" begin="showSphere"></a-animation>
        <a-animation attribute="rotation" to="0 360 0" dur="8000" repeat="indefinite" easing="linear"></a-animation>
      </a-sphere>
      <a-text id="arText" value="" color="#FFD700" align="center" position="0 0.5 0.31" width="1.2" opacity="0" aria-live="polite">
        <a-animation attribute="opacity" from="0" to="1" dur="500" begin="showText"></a-animation>
      </a-text>
      <a-entity id="stars" position="0 0.5 0"></a-entity>
    </a-entity>
  </a-scene>
  <script>
    const translations = {
      uk: {
        placeholder: "–í–≤–µ–¥—ñ—Ç—å —ñ–º'—è",
        button: "–ú–∞–≥—ñ—è ‚ú®",
        mute: "üîá",
        instructions: "–í—ñ–¥—Å–∫–∞–Ω—É–π—Ç–µ –º–∞—Ä–∫–µ—Ä –∫–∞–º–µ—Ä–æ—é –¥–ª—è AR",
        error: "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —ñ–º‚Äô—è!",
        cameraError: "–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∫–∞–º–µ—Ä–∏. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ–∑–≤–æ–ª–∏."
      },
      en: {
        placeholder: "Enter your name",
        button: "Magic ‚ú®",
        mute: "üîá",
        instructions: "Scan the marker with your camera for AR",
        error: "Please enter your name!",
        cameraError: "Failed to access camera. Check permissions."
      }
    };

    const schoolName = "–ß–æ—Ä–Ω–æ–º–æ—Ä—Å—å–∫–∏–π –ª—ñ—Ü–µ–π 6";
    const className = "4-–ë";
    const wishes = {
      uk: [
        "–°—å–æ–≥–æ–¥–Ω—ñ —Ç–≤—ñ–π –¥–µ–Ω—å –¥–ª—è –Ω–æ–≤–∏—Ö –¥—Ä—É–∑—ñ–≤!",
        "–£—Å–º—ñ—à–∫–∞ —Ä–æ–±–∏—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è –≤–µ—Å–µ–ª—ñ—à–∏–º!",
        "–ö–æ–∂–Ω–∞ –±—É–∫–≤–∞ ‚Äì –∫—Ä–æ–∫ –¥–æ –Ω–æ–≤–∏—Ö –ø—Ä–∏–≥–æ–¥!",
        "–¢–∏ –º–∞–ª–µ–Ω—å–∫–∏–π —á–∞—Ä—ñ–≤–Ω–∏–∫ —É –≤–µ–ª–∏–∫—ñ–π —à–∫–æ–ª—ñ!",
        "–ö–æ–∂–µ–Ω –¥–µ–Ω—å –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –Ω–æ–≤—ñ —ñ–¥–µ—ó!",
        "–¢–≤–æ—î —Å–µ—Ä—Ü–µ —Å–≤—ñ—Ç–∏—Ç—å—Å—è —â–∞—Å—Ç—è–º!",
        "–ì—Ä–∞–π —ñ –≤—á–∏—Å—è –æ–¥–Ω–æ—á–∞—Å–Ω–æ ‚Äì —Ü–µ –º–∞–≥—ñ—è!",
        "–¢–∏ –∑–º–æ–∂–µ—à –≤—Å–µ, —â–æ –∑–∞–¥—É–º–∞–≤!",
        "–£—Å–º—ñ—à–∫–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –≤—á–∏—Ç–∏—Å—è –ª–µ–≥–∫–æ!",
        "–ö–æ–∂–Ω–∞ –∫–Ω–∏–∂–∫–∞ ‚Äì —Å–∫–∞—Ä–± –∑–Ω–∞–Ω—å!",
        "–¢–≤–æ—è —Ñ–∞–Ω—Ç–∞–∑—ñ—è —Ä–æ–±–∏—Ç—å –¥–µ–Ω—å —è—Å–∫—Ä–∞–≤–∏–º!",
        "–¢–∏ —á–∞—Ä—ñ–≤–Ω–∏–∫ —Å–≤–æ—ó—Ö —É—Å–ø—ñ—Ö—ñ–≤!",
        "–ó–∞–≤—Ç—Ä–∞ –±—É–¥–µ —â–µ —Ü—ñ–∫–∞–≤—ñ—à–µ!",
        "–°–º—ñ–ª–∏–≤–æ –º—Ä—ñ–π —ñ –≤—ñ–¥–∫—Ä–∏–≤–∞–π –Ω–æ–≤–µ!",
        "–¢–∏ —Ä–æ–±–∏—à —Ü–µ–π —Å–≤—ñ—Ç —è—Å–∫—Ä–∞–≤—ñ—à–∏–º!"
      ],
      en: [
        "Today is your day to make new friends!",
        "A smile makes learning more fun!",
        "Every letter is a step to new adventures!",
        "You‚Äôre a little wizard in a big school!",
        "Each day brings new ideas!",
        "Your heart shines with happiness!",
        "Play and learn at the same time ‚Äì it‚Äôs magic!",
        "You can achieve anything you set your mind to!",
        "A smile makes learning easy!",
        "Every book is a treasure of knowledge!",
        "Your imagination brightens the day!",
        "You‚Äôre the wizard of your own success!",
        "Tomorrow will be even more exciting!",
        "Dream boldly and discover new things!",
        "You make the world brighter!"
      ]
    };

    let currentLang = 'uk';
    let isMuted = false;
    const inputName = document.getElementById('nameInput');
    const predictButton = document.getElementById('predictButton');
    const muteButton = document.getElementById('muteButton');
    const langSelect = document.getElementById('langSelect');
    const instructions = document.getElementById('instructions');
    const arText = document.getElementById('arText');
    const sphere = document.getElementById('magicSphere');
    const sound = document.getElementById('magicSound');

    function updateLanguage() {
      currentLang = langSelect.value;
      inputName.placeholder = translations[currentLang].placeholder;
      predictButton.textContent = translations[currentLang].button;
      muteButton.textContent = translations[currentLang].mute;
      instructions.textContent = translations[currentLang].instructions;
      document.documentElement.lang = currentLang;
    }

    function createStars() {
      const stars = document.getElementById('stars');
      for (let i = 0; i < 8; i++) {
        const sphere = document.createElement('a-sphere');
        const angle = (i / 8) * Math.PI * 2;
        sphere.setAttribute('position', `${Math.sin(angle) * 0.4} 0 ${Math.cos(angle) * 0.4}`);
        sphere.setAttribute('radius', '0.02');
        sphere.setAttribute('color', '#FFD700');
        sphere.setAttribute('animation__blink', 'property: material.color; dir: alternate; dur: 800; loop: true; to: #FF69B4');
        stars.appendChild(sphere);
      }
    }

    function checkCameraAccess() {
      if (!navigator.xr) {
        alert('–í–∞—à –ø—Ä–∏—Å—Ç—Ä—ñ–π –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î WebXR. –°–ø—Ä–æ–±—É–π—Ç–µ Chrome/Safari.');
        return;
      }
      navigator.mediaDevices.getUserMedia({ video: { width: 1280, height: 720 } })
        .then(() => console.log('Camera access granted'))
        .catch(err => {
          console.error('Camera access error:', err);
          alert(translations[currentLang].cameraError);
        });
    }

    predictButton.addEventListener('click', () => {
      const name = inputName.value.trim();
      if (!name) {
        alert(translations[currentLang].error);
        return;
      }
      if (!isMuted) {
        sound.currentTime = 0;
        sound.play().catch(() => console.error('Failed to play sound'));
      }
      const wish = wishes[currentLang][Math.floor(Math.random() * wishes[currentLang].length)];
      const message = `–ü—Ä–∏–≤—ñ—Ç, ${name} –∑ ${className} –∫–ª–∞—Å—É!\n–ú–∞–≥—ñ—á–Ω–∞ –∫—É–ª—è ${schoolName} –º–∞—î –¥–ª—è —Ç–µ–±–µ –ø–æ–±–∞–∂–∞–Ω–Ω—è ‚ú®\n${wish}`;
      arText.setAttribute('value', message);
      sphere.emit('showSphere');
      arText.emit('showText');
    });

    muteButton.addEventListener('click', () => {
      isMuted = !isMuted;
      muteButton.textContent = isMuted ? 'üîä' : 'üîá';
    });

    langSelect.addEventListener('change', updateLanguage);

    document.querySelector('a-scene').addEventListener('arError', () => {
      alert(translations[currentLang].cameraError);
    });

    document.addEventListener('DOMContentLoaded', () => {
      checkCameraAccess();
      createStars();
      updateLanguage();
    });
  </script>
</body>
</html>
